## alb에 ssl적용하기

가장 편한 방법으로 아마존에서 ssl을 구입(무료이며 가장 마음에 드는 점은 수정이 쉽다) 후 alb에 연결해서 사용한다.

### 선행조건

- alb의 보안그룹에 443이 오픈되어 있어야 하며 접근하는 EC2, ECR, ECS등에도 443포트가 오픈되어 있어야 한다.
- 443포트가 alb에 리스너로 등록되어 있어야 한다.

### 인증서를 받자

- AWS Certificate Manager에 접속한다.
- 공인 인증서를 선택한다.
- 도메인 이름에 여러개를 넣을 수 있지만 alb에 붙여서 사용하게 되므로 하나만 사용해도 된다.
- 기본적인 내용을 작성하게 되면 30분? 정도 후에 발급이 완료되었다고 나온다. 그후 인증서 화면에 보면 내가 추가한 도메인의 상태가 발급완료로 나오면 Route53에 연결해 주면 된다.
- 연결방법은 신청한 내용을 클릭하면 아래 상세값이 나오는데 거기서 도메인은 클릭하면 Route53에서 레코드 생성이라는 버튼이 있고 그것을 클릭하면 Route 53에 이름과 값이 세팅되게 된다.
- 잠시후 https로 접속하면 접속이 된다.

### 리다이렉트를 해야한다.

- 이렇게 하면 http, https둘다 접속이 가능하다. 이유는 둘다 오픈된 포트이기 때문이다. 80으로 들어온 http를 https로 리다이렉트 해주자.
- 로드벨런서에서 생성된 로드 밸런서를 선택한 후 하단의 리스너를 선택한다.
- 보면 리스너 ID에 80, 443이 있는 것을 알 수 있다. 80을 선택한 후 편집을 누른다.
- 그럼 기본작업에 다음으로 전달 -> 리스너 전달대상 으로 적혀 있을 것이다. 이것을 과감히 지운다. 그런다음 작업추가를 선택하고 리다이렉션 대상을 선택한 후 https이므로 해당 포트 번호를 입력하면 모든 작업이 종료된다.
- 그후 http로 접속하면 https로 리다이렉션 하는 것을 볼 수 있다.